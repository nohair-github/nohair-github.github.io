<html lang="en">

<head>

  <!-- Basic Page Needs -->
  <meta charset="utf-8">
  <title>No Hair Github Pages: OpenBSD Mail Server Notes - pfbadhost</title>
  <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
  <meta name="generator" content="GSB">
  <meta name="description" content="Various items of interest to the authors">
  <meta name="author" content="Our writers and correspondents">

  <!-- Mobile Specific Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT -->
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

  <!-- CSS -->
  <link rel="stylesheet" href="./normalize.css">
  <link rel="stylesheet" href="./skeleton.css">

  <!-- Favicon -->

  <!--  Scripts -->
  
</head>


<body>

<!-- Primary Page Layout -->
  
<div class="container">
  
 <!-- Header -->
    <div class="row">
		
      <div class="twelve columns" style="margin-top: 4%; text-align: center;">
        You are here: <a href="./index.html">Home</a>  > <a href="./openbsd_mailserver_pfbadhost.html">OpenBSD mail server: pfbadhost</a></br>
      </div class="twelve columns">
      
      <div class="twelve columns" style="margin-top: 3%; text-align: center;">
	  <img src="./spacer.gif" height="30px"></br>
	  <h4><b>No Hair Github Pages</b></h4>
	  </div class="twelve columns">

 	</div class ="row">

 <!-- End Header -->

 <!-- Post body -->
	<div class="row">
	
	  <div class="twelve columns" style="margin-top: 3%; text-align: center;">
		<h5><b>Setting up a mailserver on OpenBSD 6.9: pfbadhost</b></h5>
	  </div class="twelve columns">

	  <div class="twelve columns" style="margin-top: 3%; text-align: left;">

<p>K. Install pf-badhost</p>

<p>For additional spam rejection and to protect your mail server, download and install <a href="https://www.geoghegan.ca/pub/pf-badhost/">pf-badhost</a> as decribed on the authors page. (BTW, tip your local developer; both pf-badhost and unbound-adblock are worthy projects.)</p>

<p> Edit pf-badhost.sh to include blocklists for email attackers:</p>

<pre><code>....
##################################################################
# Block Lists
# Enter URL to any IP blocklist
....
### SMTP/E-Mail Attackers
https://lists.blocklist.de/lists/25.txt
https://lists.blocklist.de/lists/110.txt
https://lists.blocklist.de/lists/143.txt
https://lists.blocklist.de/lists/993.txt
https://lists.blocklist.de/lists/email.txt
https://lists.blocklist.de/lists/mail.txt
https://lists.blocklist.de/lists/imap.txt
https://lists.blocklist.de/lists/courierimap.txt
https://lists.blocklist.de/lists/courierpop3.txt
https://lists.blocklist.de/lists/pop3.txt
https://lists.blocklist.de/lists/postfix.txt
.... </code></pre>

<p>Then, restart pfbadhost to load new blocklists:</p>

<pre><code>doas -u _pfbadhost pf-badhost -O openbsd</code></pre>

<p>If you haven't done so during the installation, remember to add the block directives to /etc/pf.conf:</p>

<pre></code>...
table <pfbadhost> persist file "/etc/pf-badhost.txt"
block in quick on egress from <pfbadhost>
block out quick on egress to <pfbadhost>
...</code></pre>


<p>Next: <a href="./openbsd_mailserver_testing.html">Further testing</a></p>

<p>Previous: <a href="./openbsd_mailserver_opensmtpd2.html">OpenSMTPD tweaks and testing</a></p>

<p></br></p>

<p>Posted by Gordon, No Hair Github Pages, August 24, 2021</p>

<p>&copy; nohair.net and the author</p>

	  </div class="twelve columns">
    
	</div class="row">

 <!-- End Post body -->

 <!-- Footer --> 
	<div class="row">
      <div class="twelve columns" style="text-align: center;">
		<p>For comments, corrections, and addenda, email: gordon[AT]nohair.net</p>
		<p><a href="./index.html">Github Pages index</a> | <a href="https://www.nohair.net">Nohair.net</a> | <a href="https://www.nohair.net/links.html">Links</a> | <a href="https://www.nohair.net/cams.html">Surfcams</a></p></br>
	  </div class="twelve columns">
	</div class="row">
    
 <!-- End Footer -->

  </div class="container">

<!-- End Document -->

</body>
</html>
